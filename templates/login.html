<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login</title>

  <style>
    :root{
      --bg: #0b1220;
      --text: #e5e7eb;
      --muted: rgba(229,231,235,.72);
      --line: rgba(255,255,255,.10);
      --shadow: 0 18px 60px rgba(0,0,0,.35);

      --card: rgba(255,255,255,.06);
      --card2: rgba(255,255,255,.04);

      --primary: #4f46e5;
      --primary2: #4338ca;

      --danger: #ef4444;
      --danger-bg: rgba(239,68,68,.12);

      --success: #16a34a;
      --success-bg: rgba(22,163,74,.12);

      --radius: 18px;
    }

    *{ box-sizing:border-box; }
    html, body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue", sans-serif;
      background:
        radial-gradient(1200px 700px at 20% -10%, rgba(79,70,229,.35), transparent 55%),
        radial-gradient(900px 600px at 90% 10%, rgba(16,185,129,.20), transparent 45%),
        radial-gradient(900px 600px at 50% 100%, rgba(239,68,68,.14), transparent 50%),
        var(--bg);
      color: var(--text);
      display:grid;
      place-items:center;
      padding: 22px;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .wrap{
      width: min(460px, 100%);
    }

    .brand{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      margin-bottom: 14px;
      user-select:none;
    }
    .brand-badge{
      width: 40px; height: 40px;
      border-radius: 14px;
      background: linear-gradient(135deg, rgba(79,70,229,.95), rgba(16,185,129,.75));
      box-shadow: 0 12px 26px rgba(79,70,229,.25);
      display:grid;
      place-items:center;
      font-weight: 900;
      color: #fff;
    }
    .brand-title{
      font-weight: 900;
      letter-spacing: .2px;
    }

    .card{
      border-radius: var(--radius);
      border: 1px solid var(--line);
      background: linear-gradient(180deg, var(--card), var(--card2));
      box-shadow: var(--shadow);
      padding: 18px;
    }

    .head{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      margin-bottom: 14px;
    }
    h2{
      margin:0;
      font-size: 22px;
      letter-spacing:.2px;
    }
    .hint{
      margin: 6px 0 0 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.45;
    }

    .flash{
      padding: 12px 14px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.06);
      margin-bottom: 12px;
      color: rgba(229,231,235,.92);
      font-size: 14px;
    }
    .flash.error{ background: var(--danger-bg); border-color: rgba(239,68,68,.28); }
    .flash.success{ background: var(--success-bg); border-color: rgba(22,163,74,.30); }

    label{
      display:block;
      font-size: 13px;
      color: var(--muted);
      margin: 12px 0 6px 0;
      font-weight: 650;
    }
    select, input{
      width:100%;
      padding: 11px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--text);
      outline:none;
      font-size: 14px;
      transition: border-color .15s ease, box-shadow .15s ease, background .15s ease;
    }
    input::placeholder{ color: rgba(229,231,235,.55); }
    select:focus, input:focus{
      border-color: rgba(79,70,229,.55);
      box-shadow: 0 0 0 4px rgba(79,70,229,.18);
      background: rgba(255,255,255,.08);
    }

    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }

    .btn{
      width:100%;
      margin-top: 14px;
      padding: 11px 14px;
      border-radius: 12px;
      border: 1px solid transparent;
      cursor:pointer;
      font-weight: 800;
      font-size: 14px;
      color: #fff;
      background: var(--primary);
      transition: transform .15s ease, background .15s ease, box-shadow .15s ease, opacity .15s ease;
    }
    .btn:hover{
      background: var(--primary2);
      transform: translateY(-1px);
      box-shadow: 0 12px 28px rgba(79,70,229,.25);
    }
    .btn:active{ transform: translateY(0); opacity:.95; }

    .seg{
      display:flex;
      gap: 8px;
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 14px;
      padding: 6px;
      margin-top: 10px;
    }
    .seg button{
      flex:1;
      padding: 10px 10px;
      border-radius: 12px;
      border: 1px solid transparent;
      background: transparent;
      color: rgba(229,231,235,.78);
      cursor:pointer;
      font-weight: 800;
      transition: background .15s ease, border-color .15s ease, color .15s ease;
    }
    .seg button.active{
      background: rgba(79,70,229,.20);
      border-color: rgba(79,70,229,.38);
      color: #fff;
    }

    .footer-note{
      margin-top: 10px;
      color: rgba(229,231,235,.55);
      font-size: 12px;
      line-height: 1.45;
      text-align:center;
    }

    @media (max-width: 420px){
      .card{ padding: 16px; }
      .row{ grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="brand">
      <div class="brand-badge">SR</div>
      <div class="brand-title">SRM Do‘kon Paneli</div>
    </div>

    <div class="card">
      <div class="head">
        <div>
          <h2>Kirish</h2>
          <p class="hint">Admin — Telegram ID orqali. Sotuvchi — login/parol orqali kiradi.</p>
        </div>
      </div>

      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, message in messages %}
            <div class="flash {{ category }}">{{ message }}</div>
          {% endfor %}
        {% endif %}
      {% endwith %}

      <form method="post" autocomplete="on">
        <!-- Hidden select kept for backend compatibility -->
        <label for="login_type">Kirish turi</label>
        <select name="login_type" id="login_type" onchange="toggleFields()">
          <option value="admin">Admin (Telegram ID)</option>
          <option value="seller">Sotuvchi (login/parol)</option>
        </select>

        <!-- Premium segmented control (syncs with select) -->
        <div class="seg" role="tablist" aria-label="Kirish turi">
          <button type="button" id="seg_admin" class="active" onclick="setLoginType('admin')">Admin</button>
          <button type="button" id="seg_seller" onclick="setLoginType('seller')">Sotuvchi</button>
        </div>

        <div id="admin_fields">
          <label for="telegram_id">Telegram ID</label>
          <input type="text" name="telegram_id" id="telegram_id" placeholder="1262207928" inputmode="numeric" />
        </div>

        <div id="seller_fields" style="display:none;">
          <label for="username">Login</label>
          <input type="text" name="username" id="username" autocomplete="username" />

          <label for="password">Parol</label>
          <input type="password" name="password" id="password" autocomplete="current-password" />
        </div>

        <button class="btn" type="submit">Kirish</button>
      </form>

      <div class="footer-note">
        Xavfsizlik uchun parollarni hech kimga bermang. Admin Telegram ID faqat ruxsat berilganlar uchun ishlaydi.
      </div>
    </div>
  </div>

  <script>
    function toggleFields() {
      var type = document.getElementById('login_type').value;
      document.getElementById('admin_fields').style.display = (type === 'admin') ? 'block' : 'none';
      document.getElementById('seller_fields').style.display = (type === 'seller') ? 'block' : 'none';

      // segmented UI sync
      document.getElementById('seg_admin').classList.toggle('active', type === 'admin');
      document.getElementById('seg_seller').classList.toggle('active', type === 'seller');

      // focus for better UX
      setTimeout(function(){
        if(type === 'admin') {
          document.getElementById('telegram_id').focus();
        } else {
          document.getElementById('username').focus();
        }
      }, 50);
    }

    function setLoginType(type){
      var sel = document.getElementById('login_type');
      sel.value = type;
      toggleFields();
    }

    // initial state
    toggleFields();
  </script>
</body>
</html>
